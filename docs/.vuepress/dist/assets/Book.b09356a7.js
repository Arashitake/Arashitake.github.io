import{_ as S,f as F,u as b,l as D,m as f,F as z,v as A,G as N,a4 as R,o as s,g as n,w as g,a as T,b as V,D as W,E as q,h as o,z as C,A as H,H as $,T as G,B as M}from"./app.f9568f53.js";import{A as O,P as U}from"./Pager.a266c583.js";import{C as Y}from"./Common.31c93240.js";import{u as j,P as I,C as J,a as K}from"./Catalog.82a9e83d.js";import"./Sidebar.51f1795d.js";const Q=F({__name:"Book",setup(X){const r=M(),v=b(),y=D(),m=K(),L=m.resolve,P=m.pending,l=j(),E=f(()=>l.value?r.value.headers:[]),x=t=>t.children.length>0?[t].concat(...t.children.map(x)):t,c=f(()=>[].concat(...E.value.map(x))),e=z({headerHeight:0,screenWidth:0,catalogTop:0,activeLink:"",isFixed:!1}),i=40,B=80,u=()=>{for(let a=c.value.length-1;a>=0;a--){const k=c.value[a].slug,w=document.querySelector(`#${k}`);if((w?w.getBoundingClientRect().top:0)<=100){e.activeLink=k;break}}window.pageYOffset>e.headerHeight+i-B?(e.isFixed=!0,e.catalogTop=B):(e.isFixed=!1,e.catalogTop=e.headerHeight+i)},d=()=>{const t=document.querySelector(".post-header");e.headerHeight=t?t.offsetHeight:0,e.screenWidth=document.body.clientWidth,e.catalogTop=e.headerHeight+i};let _;A(()=>{window.addEventListener("scroll",u),d(),window.onresize=()=>(()=>{d(),u()})(),_=y.afterEach(()=>{d()})}),N(()=>{window.removeEventListener("scroll",u),_()});const{post:p}=R(),h=f(()=>{if(!p.value)return{};const t=p.value.info.next;t&&(t.text=v.value.postNext);const a=p.value.info.prev;return a&&(a.text=v.value.postPrev),{next:t,prev:a}});return(t,a)=>(s(),n(Y,null,{page:g(()=>[T(G,{name:"fade-slide-y",mode:"out-in",onBeforeEnter:o(L),onBeforeLeave:o(P)},{default:g(()=>[V("div",{class:H(["post-wrapper",{"show-catalog":o(l)}])},[W(T(O,{class:"post-header"},null,512),[[q,o(r).title]]),(s(),n(I,{key:o(r).path,class:"post-content"},{bottom:g(()=>[o(h).next||o(h).prev?(s(),n(U,{key:0,data:o(h)},null,8,["data"])):C("",!0)]),_:1})),o(l)?(s(),n(o(J),{key:0,headers:o(c),"active-link":e.activeLink,class:H({fixed:e.isFixed}),style:$({top:`${e.catalogTop}px`})},null,8,["headers","active-link","class","style"])):C("",!0)],2)]),_:1},8,["onBeforeEnter","onBeforeLeave"])]),_:1}))}});var ne=S(Q,[["__file","Book.vue"]]);export{ne as default};
